# =============================================
# TDD 验证配置
# =============================================

# AI 验证开关 (true/false)
# 默认: true
TDD_VALIDATION_ENABLED=true

# 验证客户端类型
# 可选值: 'api' | 'sdk'
#   - sdk: 使用 Claude Code 订阅 (无额外费用)
#   - api: 使用独立 API (需要配置下方 API 提供商)
# 默认: sdk
TDD_VALIDATION_CLIENT=sdk

# 原生 tdd-guard 核心配置（替代旧版 Tier）
# 客户端类型: sdk | api | cli (cli 为系统 Claude)
VALIDATION_CLIENT=sdk
# 默认模型版本（与 tdd-guard 保持一致）
TDD_GUARD_MODEL_VERSION=claude-sonnet-4-0
# 仅当 VALIDATION_CLIENT=api 时需要
TDD_GUARD_ANTHROPIC_API_KEY=
# 自定义 tdd-guard API 端点 (VALIDATION_CLIENT=api 时生效)
TDD_GUARD_ANTHROPIC_BASE_URL=

# =============================================
# API 提供商配置 (仅 TDD_VALIDATION_CLIENT=api 时生效)
# =============================================

# API 提供商选择
# 可选值:
#   - anthropic        : Anthropic 官方 API
#   - openrouter       : OpenRouter (多模型聚合)
#   - google           : Google Gemini API
#   - openai-compatible: 任何 OpenAI 兼容端点
# 默认: anthropic
TDD_API_PROVIDER=anthropic

# ---------------------------------------------
# Anthropic 配置 (TDD_API_PROVIDER=anthropic)
# ---------------------------------------------
ANTHROPIC_API_KEY=
# 自定义接入网址 (留空则使用官方 https://api.anthropic.com)
ANTHROPIC_BASE_URL=
# 可选模型:
#   - claude-3-5-haiku-20241022  (推荐: 快速便宜)
#   - claude-sonnet-4-0          (平衡)
#   - claude-opus-4-1            (最强但慢)
ANTHROPIC_MODEL=claude-3-5-haiku-20241022

# ---------------------------------------------
# OpenRouter 配置 (TDD_API_PROVIDER=openrouter)
# 获取 API Key: https://openrouter.ai/keys
# 模型列表: https://openrouter.ai/models
# ---------------------------------------------
OPENROUTER_API_KEY=
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
# 可选模型:
#   - anthropic/claude-3.5-haiku   (推荐)
#   - anthropic/claude-3.5-sonnet
#   - google/gemini-2.0-flash-exp
#   - openai/gpt-4o-mini
#   - meta-llama/llama-3.1-70b-instruct
OPENROUTER_MODEL=anthropic/claude-3.5-haiku

# ---------------------------------------------
# Google Gemini 配置 (TDD_API_PROVIDER=google)
# 获取 API Key: https://aistudio.google.com/apikey
# ---------------------------------------------
GOOGLE_API_KEY=
# 自定义接入网址 (留空则使用官方 https://generativelanguage.googleapis.com)
GOOGLE_BASE_URL=
# 可选模型:
#   - gemini-2.0-flash-exp  (推荐: 免费有限额)
#   - gemini-1.5-flash
#   - gemini-1.5-pro
GOOGLE_MODEL=gemini-2.0-flash-exp

# ---------------------------------------------
# OpenAI-compatible 配置 (TDD_API_PROVIDER=openai-compatible)
# 支持: OpenAI, Azure OpenAI, Groq, Together AI 等
# ---------------------------------------------
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1
# 可选模型 (取决于端点):
#   - gpt-4o-mini     (OpenAI 推荐)
#   - gpt-4o
#   - llama-3.1-70b   (Groq/Together)
OPENAI_MODEL=gpt-4o-mini

# =============================================
# AST 检查配置 (独立于 AI 验证，永远免费)
# =============================================

# AST 检查开关
# 默认: true
TDD_AST_CHECKS_ENABLED=true

# 拒绝空测试体
TDD_REJECT_EMPTY_TESTS=true

# 拒绝缺少断言的测试
TDD_REJECT_MISSING_ASSERTIONS=true

# 拒绝无意义断言 (expect(true).toBe(true))
TDD_REJECT_TRIVIAL_ASSERTIONS=true

# =============================================
# 运行时配置
# =============================================

# 日志级别: debug, info, warn, error
LOG_LEVEL=info

# .fusion 目录位置 (相对于项目根目录)
# 报告器会复制到 .fusion/reporters/ 并写入 test-results.json
FUSION_STATE_DIR=.fusion

# =============================================
# TDD Guard 配置 (从 tdd-guard 迁移的功能)
# =============================================

# Linter 类型
# 可选值: 'eslint' | 'none'
# 默认: none
TDD_LINTER_TYPE=none

# 测试通过后运行 Linter (重构阶段)
# 默认: true
TDD_LINT_ON_GREEN=true

# Lint 错误阻断编辑 (首次警告后)
# 默认: false
TDD_LINT_BLOCK=false

# 启用 Risk Tier 分级 TDD 强制
# 默认: true
TDD_RISK_TIER_ENABLED=true

# 最小强制 Tier (0-3)
# Tier 0: 文档，无检查
# Tier 1: 样式/配置，仅记录
# Tier 2: 业务逻辑，需要测试或豁免
# Tier 3: 核心逻辑，必须有失败测试
# 默认: 2
TDD_MIN_ENFORCE_TIER=2

# 忽略的文件模式 (逗号分隔)
# 默认: *.md,*.json,*.yml,*.yaml,*.css,*.scss,*.svg
TDD_IGNORE_PATTERNS=*.md,*.json,*.yml,*.yaml,*.css,*.scss,*.svg
